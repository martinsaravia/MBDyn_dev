% RUTINA DE CALCULO DE PROPIEDAD DEL SEGMENTO
% DEFINICION ANTIHORARIA y matriz J integrada en el espesor

function [D,DM] = DJseg_AH_w (nseg,C,wseg,s0,s1,Dy,Dz,Ds,y0,z0,dYs,dZs,dws)




A11=C(1,1); A16=C(1,2);               B11=C(1,4);  B16=C(1,5);   
            A66=C(2,2);                            B66=C(2,5); 
                          A55=0*C(3,3);   
                                      D11=C(4,4);  D16=C(4,5); 
                                                   D66=C(5,5); 
                                                   

                                                   
D = [A11*Ds -(B11*Dy) + (A11*Ds*(Dz + 2*z0))/2 B11*Dz + (A11*Ds*(Dy + ...
    2*y0))/2 A16*Dy A16*Dz (B16*(Dy^2 + Dz^2) + A16*Ds*(Ds*dws + Dz*y0 - ...
    Dy*z0))/Ds (3*B11*Dz*(Dy + 2*y0) + A11*Ds*(Dy^2 + 3*Dy*y0 + ...
    3*y0^2))/6 (-3*B11*Dy*(Dz + 2*z0) + A11*Ds*(Dz^2 + 3*Dz*z0 + ...
    3*z0^2))/6 (A11*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + ...
    3*B11*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0)))/6;

    -(B11*Dy) + (A11*Ds*(Dz + 2*z0))/2 (D11*Dy^2)/Ds - B11*Dy*(Dz + 2*z0) ...
    + (A11*Ds*(Dz^2 + 3*Dz*z0 + 3*z0^2))/3 (-6*D11*Dy*Dz + ...
    A11*Ds^2*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + 3*B11*Ds*(-(Dy*(Dy ...
    + 2*y0)) + Dz*(Dz + 2*z0)))/(6*Ds) (Dy*((-2*B16*Dy)/Ds + A16*(Dz + ...
    2*z0)))/2 (Dz*((-2*B16*Dy)/Ds + A16*(Dz + 2*z0)))/2 (Ds*(Ds*dws + ...
    Dz*y0 - Dy*z0)*(-2*B16*Dy + A16*Ds*(Dz + 2*z0)) + (Dy^2 + ...
    Dz^2)*(-2*D16*Dy + B16*Ds*(Dz + 2*z0)))/(2*Ds^2) (-12*D11*Dy*Dz*(Dy + ...
    2*y0) + A11*Ds^2*(6*y0^2*(Dz + 2*z0) + 4*Dy*y0*(2*Dz + 3*z0) + ...
    Dy^2*(3*Dz + 4*z0)) - 4*B11*Ds*(Dy^3 + 3*Dy^2*y0 - 3*Dz*y0*(Dz + ...
    2*z0) + Dy*(-2*Dz^2 + 3*y0^2 - 3*Dz*z0)))/(24*Ds) (4*D11*Dy^2*(Dz + ...
    2*z0) - Ds*(4*B11*Dy*(Dz^2 + 3*Dz*z0 + 3*z0^2) - A11*Ds*(Dz + ...
    2*z0)*(z0^2 + (Dz + z0)^2)))/(8*Ds) (6*D11*Dy*(Dy^2 + 2*Dy*y0 - ...
    Dz*(Dz + 2*z0)) + Ds*(A11*Ds*(Dz^2*(3*Dy + 4*y0) + 4*Dz*(2*Dy + ...
    3*y0)*z0 + 6*(Dy + 2*y0)*z0^2) - 4*B11*(3*Dy*y0*(Dz + 2*z0) + ...
    Dy^2*(2*Dz + 3*z0) - Dz*(Dz^2 + 3*Dz*z0 + 3*z0^2))))/(12*Ds);

    B11*Dz + (A11*Ds*(Dy + 2*y0))/2 (-6*D11*Dy*Dz + A11*Ds^2*(2*Dy*Dz + ...
    3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + 3*B11*Ds*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + ...
    2*z0)))/(6*Ds) (A11*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2))/3 + Dz*((D11*Dz)/Ds ...
    + B11*(Dy + 2*y0)) (B16*Dy*Dz)/Ds + (A16*Dy*(Dy + 2*y0))/2 ...
    (B16*Dz^2)/Ds + (A16*Dz*(Dy + 2*y0))/2 -(-((Dy^2 + Dz^2)*(2*D16*Dz + ...
    B16*Ds*(Dy + 2*y0))) - Ds*(2*B16*Dz + A16*Ds*(Dy + 2*y0))*(Ds*dws + ...
    Dz*y0 - Dy*z0))/(2*Ds^2) (A11*Ds^2*(Dy + 2*y0)*(Dy^2 + 2*Dy*y0 + ...
    2*y0^2) + 4*Dz*(D11*Dz*(Dy + 2*y0) + B11*Ds*(Dy^2 + 3*Dy*y0 + ...
    3*y0^2)))/(8*Ds) (-12*D11*Dy*Dz*(Dz + 2*z0) + A11*Ds^2*(Dz^2*(3*Dy + ...
    4*y0) + 4*Dz*(2*Dy + 3*y0)*z0 + 6*(Dy + 2*y0)*z0^2) - ...
    4*B11*Ds*(3*Dy*y0*(Dz + 2*z0) + Dy^2*(2*Dz + 3*z0) - Dz*(Dz^2 + ...
    3*Dz*z0 + 3*z0^2)))/(24*Ds) (6*D11*Dz*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + ...
    2*z0)) + A11*Ds^2*(6*y0^2*(Dz + 2*z0) + 4*Dy*y0*(2*Dz + 3*z0) + ...
    Dy^2*(3*Dz + 4*z0)) - 4*B11*Ds*(Dy^3 + 3*Dy^2*y0 - 3*Dz*y0*(Dz + ...
    2*z0) + Dy*(-2*Dz^2 + 3*y0^2 - 3*Dz*z0)))/(12*Ds);

    A16*Dy (Dy*((-2*B16*Dy)/Ds + A16*(Dz + 2*z0)))/2 (B16*Dy*Dz)/Ds + ...
    (A16*Dy*(Dy + 2*y0))/2 (A66*Dy^2 + A55*Dz^2)/Ds ((-A55 + ...
    A66)*Dy*Dz)/Ds (2*B66*Dy*(Dy^2 + Dz^2) + 2*A66*Ds*Dy*(Ds*dws + Dz*y0 ...
    - Dy*z0) - A55*Ds*Dz*(Dy^2 + Dz^2 + 2*Dy*y0 + 2*Dz*z0))/(2*Ds^2) ...
    (Dy*(3*B16*Dz*(Dy + 2*y0) + A16*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2)))/(6*Ds) ...
    (Dy*(-3*B16*Dy*(Dz + 2*z0) + A16*Ds*(Dz^2 + 3*Dz*z0 + ...
    3*z0^2)))/(6*Ds) (Dy*(A16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) ...
    + 3*B16*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0))))/(6*Ds);

    A16*Dz (Dz*((-2*B16*Dy)/Ds + A16*(Dz + 2*z0)))/2 (B16*Dz^2)/Ds + ...
    (A16*Dz*(Dy + 2*y0))/2 ((-A55 + A66)*Dy*Dz)/Ds (A55*Dy^2 + ...
    A66*Dz^2)/Ds (A55*Ds*Dy*(Dy^2 + 2*Dy*y0 + Dz*(Dz + 2*z0)) + ...
    2*Dz*(B66*(Dy^2 + Dz^2) + A66*Ds*(Ds*dws + Dz*y0 - Dy*z0)))/(2*Ds^2) ...
    (Dz*(3*B16*Dz*(Dy + 2*y0) + A16*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2)))/(6*Ds) ...
    (Dz*(-3*B16*Dy*(Dz + 2*z0) + A16*Ds*(Dz^2 + 3*Dz*z0 + ...
    3*z0^2)))/(6*Ds) (Dz*(A16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) ...
    + 3*B16*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0))))/(6*Ds);

    (B16*(Dy^2 + Dz^2) + A16*Ds*(Ds*dws + Dz*y0 - Dy*z0))/Ds ...
    (-2*D16*Dy*(Dy^2 + Dz^2) + A16*Ds^2*(Dz + 2*z0)*(Ds*dws + Dz*y0 - ...
    Dy*z0) + B16*Ds*(-2*Ds*dws*Dy - 2*Dy*Dz*y0 + Dz^2*(Dz + 2*z0) + ...
    Dy^2*(Dz + 4*z0)))/(2*Ds^2) (2*D16*Dz*(Dy^2 + Dz^2) + B16*Ds*(Dy^3 + ...
    2*Dy^2*y0 + 2*Dz*(Ds*dws + 2*Dz*y0) + Dy*Dz*(Dz - 2*z0)) + ...
    A16*Ds^2*(Dy + 2*y0)*(Ds*dws + Dz*y0 - Dy*z0))/(2*Ds^2) ...
    (2*B66*Dy*(Dy^2 + Dz^2) + 2*A66*Ds*Dy*(Ds*dws + Dz*y0 - Dy*z0) - ...
    A55*Ds*Dz*(Dy^2 + Dz^2 + 2*Dy*y0 + 2*Dz*z0))/(2*Ds^2) ...
    (A55*Ds*Dy*(Dy^2 + 2*Dy*y0 + Dz*(Dz + 2*z0)) + 2*Dz*(B66*(Dy^2 + ...
    Dz^2) + A66*Ds*(Ds*dws + Dz*y0 - Dy*z0)))/(2*Ds^2) (Ds^2*(Ds*dws + ...
    Dz*y0 - Dy*z0)*(B66*(Dy^2 + Dz^2) + A66*Ds*(Ds*dws + Dz*y0 - Dy*z0)) ...
    + Ds*(Dy^2 + Dz^2)*(D66*(Dy^2 + Dz^2) + B66*Ds*(Ds*dws + Dz*y0 - ...
    Dy*z0)) - (A55*Ds^3*((Dy*y0 + Dz*z0)^3 - (Dy*(Dy + y0) + Dz*(Dz + ...
    z0))^3))/(3*(Dy^2 + Dz^2)))/Ds^4 -(-(Ds^3*(Dy^2 + 3*Dy*y0 + ...
    3*y0^2)*(B16*(Dy^2 + Dz^2) + A16*Ds*(Ds*dws + Dz*y0 - Dy*z0)))/3 - ...
    Ds^2*Dz*(Dy + 2*y0)*(D16*(Dy^2 + Dz^2) + B16*Ds*(Ds*dws + Dz*y0 - ...
    Dy*z0)))/(2*Ds^4) (-3*D16*Dy*(Dy^2 + Dz^2)*(Dz + 2*z0) + ...
    A16*Ds^2*(Ds*dws + Dz*y0 - Dy*z0)*(Dz^2 + 3*Dz*z0 + 3*z0^2) + ...
    B16*Ds*(-3*Ds*dws*Dy*(Dz + 2*z0) - 3*Dy*Dz*y0*(Dz + 2*z0) + Dy^2*(Dz ...
    + 3*z0)^2 + Dz^2*(Dz^2 + 3*Dz*z0 + 3*z0^2)))/(6*Ds^2) (Ds*(2*Dy*Dz + ...
    3*Dz*y0 + 3*Dy*z0 + 6*y0*z0)*(B16*(Dy^2 + Dz^2) + A16*Ds*(Ds*dws + ...
    Dz*y0 - Dy*z0)) - 3*(Dy^2 + 2*Dy*y0 - Dz*(Dz + 2*z0))*(D16*(Dy^2 + ...
    Dz^2) + B16*Ds*(Ds*dws + Dz*y0 - Dy*z0)))/(6*Ds^2);

    (3*B11*Dz*(Dy + 2*y0) + A11*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2))/6 ...
    (-12*D11*Dy*Dz*(Dy + 2*y0) + A11*Ds^2*(6*y0^2*(Dz + 2*z0) + ...
    4*Dy*y0*(2*Dz + 3*z0) + Dy^2*(3*Dz + 4*z0)) - 4*B11*Ds*(Dy^3 + ...
    3*Dy^2*y0 - 3*Dz*y0*(Dz + 2*z0) + Dy*(-2*Dz^2 + 3*y0^2 - ...
    3*Dz*z0)))/(24*Ds) (A11*Ds^2*(Dy + 2*y0)*(y0^2 + (Dy + y0)^2) + ...
    4*Dz*(D11*Dz*(Dy + 2*y0) + B11*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2)))/(8*Ds) ...
    (Dy*(3*B16*Dz*(Dy + 2*y0) + A16*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2)))/(6*Ds) ...
    (Dz*(3*B16*Dz*(Dy + 2*y0) + A16*Ds*(Dy^2 + 3*Dy*y0 + 3*y0^2)))/(6*Ds) ...
    (3*D16*Dz*(Dy^2 + Dz^2)*(Dy + 2*y0) + A16*Ds^2*(Dy^2 + 3*Dy*y0 + ...
    3*y0^2)*(Ds*dws + Dz*y0 - Dy*z0) + B16*Ds*(Dy^4 + 3*Dy^3*y0 + ...
    3*Dz*y0*(2*Ds*dws + 3*Dz*y0) + Dy^2*(Dz^2 + 3*y0^2 - 3*Dz*z0) + ...
    3*Dy*Dz*(Ds*dws + 2*Dz*y0 - 2*y0*z0)))/(6*Ds^2) (3*A11*Ds^2*(Dy^4 + ...
    5*Dy^3*y0 + 10*Dy^2*y0^2 + 10*Dy*y0^3 + 5*y0^4) - ...
    5*Dz*(-4*D11*Dz*(Dy^2 + 3*Dy*y0 + 3*y0^2) - 3*B11*Ds*(Dy + ...
    2*y0)*(y0^2 + (Dy + y0)^2)))/(60*Ds) (-20*D11*Dy*Dz*(2*Dy*Dz + ...
    3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + A11*Ds^2*(10*y0^2*(Dz^2 + 3*Dz*z0 + ...
    3*z0^2) + 5*Dy*y0*(3*Dz^2 + 8*Dz*z0 + 6*z0^2) + Dy^2*(6*Dz^2 + ...
    15*Dz*z0 + 10*z0^2)) - 5*B11*Ds*(4*Dy^2*y0*(2*Dz + 3*z0) + Dy^3*(3*Dz ...
    + 4*z0) - 4*Dz*y0*(Dz^2 + 3*Dz*z0 + 3*z0^2) + Dy*(-3*Dz^3 - 8*Dz^2*z0 ...
    + 12*y0^2*z0 + 6*Dz*(y0 - z0)*(y0 + z0))))/(120*Ds) ...
    (3*A11*Ds^2*(10*y0^3*(Dz + 2*z0) + 10*Dy*y0^2*(2*Dz + 3*z0) + ...
    5*Dy^2*y0*(3*Dz + 4*z0) + Dy^3*(4*Dz + 5*z0)) - 15*B11*Ds*(Dy^4 + ...
    4*Dy^3*y0 - 6*Dz*y0^2*(Dz + 2*z0) + Dy^2*(-3*Dz^2 + 6*y0^2 - 4*Dz*z0) ...
    + 4*Dy*y0*(-2*Dz^2 + y0^2 - 3*Dz*z0)) + 20*D11*Dz*(-2*Dy^3 - ...
    6*Dy^2*y0 + 3*Dz*y0*(Dz + 2*z0) + Dy*(2*Dz^2 - 6*y0^2 + ...
    3*Dz*z0)))/(120*Ds);

    (-3*B11*Dy*(Dz + 2*z0) + A11*Ds*(Dz^2 + 3*Dz*z0 + 3*z0^2))/6 ...
    (4*D11*Dy^2*(Dz + 2*z0) - Ds*(4*B11*Dy*(Dz^2 + 3*Dz*z0 + 3*z0^2) - ...
    A11*Ds*(Dz + 2*z0)*(z0^2 + (Dz + z0)^2)))/(8*Ds) (-12*D11*Dy*Dz*(Dz + ...
    2*z0) + A11*Ds^2*(Dz^2*(3*Dy + 4*y0) + 4*Dz*(2*Dy + 3*y0)*z0 + 6*(Dy ...
    + 2*y0)*z0^2) - 4*B11*Ds*(3*Dy*y0*(Dz + 2*z0) + Dy^2*(2*Dz + 3*z0) - ...
    Dz*(Dz^2 + 3*Dz*z0 + 3*z0^2)))/(24*Ds) (Dy*(-3*B16*Dy*(Dz + 2*z0) + ...
    A16*Ds*(Dz^2 + 3*Dz*z0 + 3*z0^2)))/(6*Ds) (Dz*(-3*B16*Dy*(Dz + 2*z0) ...
    + A16*Ds*(Dz^2 + 3*Dz*z0 + 3*z0^2)))/(6*Ds) (-3*D16*Dy*(Dy^2 + ...
    Dz^2)*(Dz + 2*z0) + A16*Ds^2*(Ds*dws + Dz*y0 - Dy*z0)*(Dz^2 + 3*Dz*z0 ...
    + 3*z0^2) + B16*Ds*(-3*Ds*dws*Dy*(Dz + 2*z0) - 3*Dy*Dz*y0*(Dz + 2*z0) ...
    + Dy^2*(Dz + 3*z0)^2 + Dz^2*(Dz^2 + 3*Dz*z0 + 3*z0^2)))/(6*Ds^2) ...
    (-20*D11*Dy*Dz*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + ...
    A11*Ds^2*(10*y0^2*(Dz^2 + 3*Dz*z0 + 3*z0^2) + 5*Dy*y0*(3*Dz^2 + ...
    8*Dz*z0 + 6*z0^2) + Dy^2*(6*Dz^2 + 15*Dz*z0 + 10*z0^2)) - ...
    5*B11*Ds*(4*Dy^2*y0*(2*Dz + 3*z0) + Dy^3*(3*Dz + 4*z0) - ...
    4*Dz*y0*(Dz^2 + 3*Dz*z0 + 3*z0^2) + Dy*(-3*Dz^3 - 8*Dz^2*z0 + ...
    12*y0^2*z0 + 6*Dz*(y0 - z0)*(y0 + z0))))/(120*Ds) (20*D11*Dy^2*(Dz^2 ...
    + 3*Dz*z0 + 3*z0^2) - 3*Ds*(-(A11*Ds*(Dz^4 + 5*Dz^3*z0 + 10*Dz^2*z0^2 ...
    + 10*Dz*z0^3 + 5*z0^4)) + 5*B11*Dy*(Dz + 2*z0)*(z0^2 + (Dz + ...
    z0)^2)))/(60*Ds) (20*D11*Dy*(3*Dy*y0*(Dz + 2*z0) + Dy^2*(2*Dz + 3*z0) ...
    - 2*Dz*(Dz^2 + 3*Dz*z0 + 3*z0^2)) + 3*Ds*(5*B11*(Dz*(Dz + 2*z0)*(Dz^2 ...
    + 2*Dz*z0 + 2*z0^2) - 4*Dy*y0*(Dz^2 + 3*Dz*z0 + 3*z0^2) - ...
    Dy^2*(3*Dz^2 + 8*Dz*z0 + 6*z0^2)) + A11*Ds*(5*y0*(Dz + 2*z0)*(Dz^2 + ...
    2*Dz*z0 + 2*z0^2) + Dy*(4*Dz^3 + 15*Dz^2*z0 + 20*Dz*z0^2 + ...
    10*z0^3))))/(120*Ds);

    (A11*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + 3*B11*(-(Dy*(Dy + ...
    2*y0)) + Dz*(Dz + 2*z0)))/6 (6*D11*Dy*(Dy^2 + 2*Dy*y0 - Dz*(Dz + ...
    2*z0)) + Ds*(A11*Ds*(Dz^2*(3*Dy + 4*y0) + 4*Dz*(2*Dy + 3*y0)*z0 + ...
    6*(Dy + 2*y0)*z0^2) - 4*B11*(3*Dy*y0*(Dz + 2*z0) + Dy^2*(2*Dz + 3*z0) ...
    - Dz*(Dz^2 + 3*Dz*z0 + 3*z0^2))))/(12*Ds) (6*D11*Dz*(-(Dy*(Dy + ...
    2*y0)) + Dz*(Dz + 2*z0)) + A11*Ds^2*(6*y0^2*(Dz + 2*z0) + ...
    4*Dy*y0*(2*Dz + 3*z0) + Dy^2*(3*Dz + 4*z0)) - 4*B11*Ds*(Dy^3 + ...
    3*Dy^2*y0 - 3*Dz*y0*(Dz + 2*z0) + Dy*(-2*Dz^2 + 3*y0^2 - ...
    3*Dz*z0)))/(12*Ds) (Dy*(A16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + ...
    6*y0*z0) + 3*B16*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0))))/(6*Ds) ...
    (Dz*(A16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + 3*B16*(-(Dy*(Dy ...
    + 2*y0)) + Dz*(Dz + 2*z0))))/(6*Ds) (Ds*(Ds*dws + Dz*y0 - ...
    Dy*z0)*(A16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + ...
    3*B16*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0))) + (Dy^2 + ...
    Dz^2)*(B16*Ds*(2*Dy*Dz + 3*Dz*y0 + 3*Dy*z0 + 6*y0*z0) + ...
    3*D16*(-(Dy*(Dy + 2*y0)) + Dz*(Dz + 2*z0))))/(6*Ds^2) ...
    (3*A11*Ds^2*(10*y0^3*(Dz + 2*z0) + 10*Dy*y0^2*(2*Dz + 3*z0) + ...
    5*Dy^2*y0*(3*Dz + 4*z0) + Dy^3*(4*Dz + 5*z0)) - 15*B11*Ds*(Dy^4 + ...
    4*Dy^3*y0 - 6*Dz*y0^2*(Dz + 2*z0) + Dy^2*(-3*Dz^2 + 6*y0^2 - 4*Dz*z0) ...
    + 4*Dy*y0*(-2*Dz^2 + y0^2 - 3*Dz*z0)) + 20*D11*Dz*(-2*Dy^3 - ...
    6*Dy^2*y0 + 3*Dz*y0*(Dz + 2*z0) + Dy*(2*Dz^2 - 6*y0^2 + ...
    3*Dz*z0)))/(120*Ds) (20*D11*Dy*(3*Dy*y0*(Dz + 2*z0) + Dy^2*(2*Dz + ...
    3*z0) - 2*Dz*(Dz^2 + 3*Dz*z0 + 3*z0^2)) + 3*Ds*(5*B11*(Dz*(Dz + ...
    2*z0)*(Dz^2 + 2*Dz*z0 + 2*z0^2) - 4*Dy*y0*(Dz^2 + 3*Dz*z0 + 3*z0^2) - ...
    Dy^2*(3*Dz^2 + 8*Dz*z0 + 6*z0^2)) + A11*Ds*(5*y0*(Dz + 2*z0)*(Dz^2 + ...
    2*Dz*z0 + 2*z0^2) + Dy*(4*Dz^3 + 15*Dz^2*z0 + 20*Dz*z0^2 + ...
    10*z0^3))))/(120*Ds) (10*D11*(Dy^4 + 3*Dy^3*y0 - 3*Dy*Dz*y0*(Dz + ...
    2*z0) + Dy^2*(-2*Dz^2 + 3*y0^2 - 3*Dz*z0) + Dz^2*(Dz^2 + 3*Dz*z0 + ...
    3*z0^2)) + Ds*(A11*Ds*(10*y0^2*(Dz^2 + 3*Dz*z0 + 3*z0^2) + ...
    5*Dy*y0*(3*Dz^2 + 8*Dz*z0 + 6*z0^2) + Dy^2*(6*Dz^2 + 15*Dz*z0 + ...
    10*z0^2)) - 5*B11*(4*Dy^2*y0*(2*Dz + 3*z0) + Dy^3*(3*Dz + 4*z0) - ...
    4*Dz*y0*(Dz^2 + 3*Dz*z0 + 3*z0^2) + Dy*(-3*Dz^3 - 8*Dz^2*z0 + ...
    12*y0^2*z0 + 6*Dz*(y0 - z0)*(y0 + z0)))))/(30*Ds)];


% SECTION MASS MATRIX

I0 = zeros(3,3);

M = dia3(wseg*Ds); % Segment Mass

J = wseg * [-(dYs^2*s0^3)/3 - (dZs^2*s0^3)/3 + (dYs^2*s1^3)/3 + (dZs^2*s1^3)/3 - dYs*s0^2*y0 + dYs*s1^2*y0 - s0*y0^2 + s1*y0^2 - dZs*s0^2*z0 + dZs*s1^2*z0 - s0*z0^2 + s1*z0^2                      0                      0;
                0                      -(dZs^2*s0^3)/3 + (dZs^2*s1^3)/3 - dZs*s0^2*z0 + dZs*s1^2*z0 - s0*z0^2 + s1*z0^2                      ((s0 - s1)*(2*dYs*dZs*(s0^2 + s0*s1 + s1^2) + 3*dZs*(s0 + s1)*y0 + 3*dYs*(s0 + s1)*z0 + 6*y0*z0))/6;
                0                      ((s0 - s1)*(2*dYs*dZs*(s0^2 + s0*s1 + s1^2) + 3*dZs*(s0 + s1)*y0 + 3*dYs*(s0 + s1)*z0 + 6*y0*z0))/6                      -(dYs^2*s0^3)/3 + (dYs^2*s1^3)/3 - dYs*s0^2*y0 + dYs*s1^2*y0 - s0*y0^2 + s1*y0^2] ;

DM = [  M       I0 ; 
        I0      J  ];

%NOTE: J matrix is integrated in thickness

rn = y0*dZs-z0*dYs;
if rn >= 0
    disp(['WARNING: Negative normal coordinate for segment  ' num2str(nseg) ' '])
end



